+function(a){"use strict";function c(c,d,e,f){var g="";return this.each(function(){var h=a(this),i=h.data("bz.calendario"),j="object"==typeof c&&c;return i||h.data("bz.calendario",i=new b(this,j)),"string"==typeof c&&a.isFunction(i[c])?g=i[c](d,e,f):"string"==typeof c?g=i.option(d,e):void 0}),g?g:void a(document).trigger(a.Event("finish.calendar.calendario"))}var b=function(a,b){this.init("calendario",a,b)};b.INFO={EMAIL:"%email%",FEED:"%feed%",NAME:"HangingTime!",VERSION:"5.0.2",UNIQUE:"%unique%",USER:"%user%",UPDATEURL:"%url%"},b.DEFAULTS={weeks:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekabbrs:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthabbrs:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],displayWeekAbbr:!1,displayMonthAbbr:!1,startIn:1,fillEmpty:!0,zone:"00:00",events:["click","focus"],checkUpdate:!0,weekdays:"MON, TUE, WED, THU, FRI",weekends:"SAT, SUN",format:"MM-DD-YYYY",feed:"http://calendario.t15.org/sync/"},b.prototype.init=function(c,d,e){this.INFO=b.INFO,this.type=c,this.$element=a(d),this.options=a.extend({},b.DEFAULTS,this.$element.data(),e),this.today=new Date,this.month=isNaN(this.options.month)||null===this.options.month?this.today.getMonth():this.options.month-1,this.year=isNaN(this.options.year)||null===this.options.year?this.today.getFullYear():this.options.year,this.caldata=this.processCaldata(this.options.caldata),this.curData=[],this.syncData={},this.generateTemplate(),this.initEvents()},b.prototype.sync=function(b){var c=this;return a.post(c.options.feed,{info:c.INFO,caldata:b,domain:document.domain},function(a){c.syncData=a},"json"),b},b.prototype.initEvents=function(){this.$element.on(this.options.events.join(".calendario ").trim()+".calendario","div.fc-row > div:not(:empty)",function(b){a(this).trigger(a.Event("onDay"+b.type.charAt(0).toUpperCase()+b.type.slice(1)),[a(this).data("bz.calendario.dateprop")])})},b.prototype.propDate=function(){var c,d,e,f,g,h,b=this;this.$element.find("div.fc-row > div").filter(":not(:empty)").each(function(){f=a(this).children("span.fc-date").hasClass("fc-emptydate"),e=a(this).children("span.fc-date").text(),c=f&&e<=31&&e>=24?b.month-1:f&&e>=1&&e<=7?b.month+1:b.month,d=12==c?b.year+1:c==-1?b.year-1:b.year,c=12==c?0:c==-1?11:c,g=!!b.curData[e]&&b.curData[e],g?(h={html:[],allDay:[],startTime:[],endTime:[],note:[],content:[],url:[]},a.each(g.startTime,function(a,b){b.getDate()==e&&b.getMonth()==c&&b.getFullYear()==d&&(h.startTime.push(b),h.endTime.push(g.endTime[a]),h.allDay.push(g.allDay[a]),h.html.push(g.html[a]),h.note.push(g.note[a]),h.content.push(g.content[a]),h.url.push(g.url[a]))}),0==h.html.length&&(h=!1)):h=!1;var i={day:a(this).children("span.fc-date").text(),month:c+1,monthname:b.options.displayMonthAbbr?b.options.monthabbrs[c]:b.options.months[c],year:d,weekday:a(this).index()+b.options.startIn,weekdayname:b.options.weeks[6==a(this).index()?0:a(this).index()+b.options.startIn],data:h};a(this).data("bz.calendario.dateprop",i)})},b.prototype.insertToCaldata=function(a,b,c,d,e){return d[a]||(d[a]=[]),b.repeat?b.day=[c[e.DD],b.endDate.split("-")[e.DD]]:b.day=[c[e.DD],c[e.DD]],b.repeat?b.month=[c[e.MM],b.endDate.split("-")[e.MM]]:b.month=[c[e.MM],c[e.MM]],b.repeat?b.year=[c[e.YYYY],b.endDate.split("-")[e.YYYY]]:b.year=[c[e.YYYY],c[e.YYYY]],b.category=b.category?"calendar-"+b.category.split("-").pop():"calendar-default",d[a].push(b)?d:d},b.prototype.processCaldata=function(b){var c={},d=this,e={};return a.each(this.options.format.toUpperCase().split("-"),function(a,b){e[b]=a}),a.each(b,function(b,f){a.each(f,function(f,g){"INTERVAL"==g.repeat||"EVERYDAY"==g.repeat?g.repeat="MON, TUE, WED, THU, FRI, SAT, SUN":"WEEKDAYS"==g.repeat?g.repeat=d.options.weekdays:"WEEKENDS"==g.repeat&&(g.repeat=d.options.weekends),a.inArray(g.repeat,[void 0,"YEARLY","MONTHLY"])!=-1?c=d.insertToCaldata(parseInt(b.split("-")[e.DD]),g,b.split("-"),c,e):g.repeat&&a.each(g.repeat.split(","),function(f,h){c=d.insertToCaldata(h.trim(),a.extend(g,{repeat:"WEEKLY"}),b.split("-"),c,e)})})}),d.sync(c)},b.prototype.toDObj=function(a,b){var c=parseInt(this.options.zone.split(":")[0]),d=parseInt(this.options.zone.charAt(0)+this.options.zone.split(":")[1]),e=parseInt(a.split(":")[0])-c,f=parseInt(a.split(":")[1])-d;return new Date(Date.UTC(this.year,this.month,b,e,f,0,0))},b.prototype.parseDay=function(a,b){this.curData[b]||(this.curData[b]={html:[],allDay:[],startTime:[],endTime:[],note:[],content:[],url:[],rawDate:[]}),a.allDay?this.curData[b].allDay.push(!0):this.curData[b].allDay.push(!1),a.allDay?this.curData[b].startTime.push(this.toDObj("00:00",b)):this.curData[b].startTime.push(this.toDObj(a.startTime,b)),a.allDay?this.curData[b].endTime.push(this.toDObj("23:59",b)):this.curData[b].endTime.push(this.toDObj(a.endTime,b)),a.note?this.curData[b].note.push(a.note):this.curData[b].note.push(""),a.content?this.curData[b].content.push(a.content):this.curData[b].content.push(""),a.url?this.curData[b].url.push(a.url):this.curData[b].url.push("");var c=a.url?this.curData[b].html.push('<a class="'+a.category+'" href="'+a.url+'">'+a.content+"</a>")-1:this.curData[b].html.push('<span class="'+a.category+'">'+a.content+"</span>")-1;this.curData[b].html[c]+='<time class="fc-allday" datetime="'+this.curData[b].allDay[c]+'"></time>',this.curData[b].html[c]+='<time class="fc-starttime" datetime="'+this.curData[b].startTime[c].toISOString()+'"></time>',this.curData[b].html[c]+='<time class="fc-endtime" datetime="'+this.curData[b].endTime[c].toISOString()+'"></time>',this.curData[b].html[c]+="<note>"+this.curData[b].note[c]+"</note>",this.curData[b].rawDate.push(new Date(a.year[0],a.month[0]-1)),this.isProperlyParsed=!0},b.prototype.parseDataToDay=function(b,c,d){var e=a.extend({},this,d);if(e.isProperlyParsed=!1,a.each(b,function(a,b){b&&("YEARLY"==b.repeat||"MONTHLY"==b.repeat||"WEEKLY"==b.repeat?e.year>=b.year[0]&&e.year<=b.year[1]&&("YEARLY"==b.repeat&&e.month+1==b.month[0]&&e.parseDay(b,c),e.year==b.year[0]&&e.month+1>=b.month[0]?("MONTHLY"==b.repeat&&e.parseDay(b,c),"WEEKLY"==b.repeat&&(b.month[0]+b.year[0]==b.month[1]+b.year[1]?b.month[0]==e.month+1&&b.day[1]>=c&&c>=b.day[0]&&e.parseDay(b,c):b.month[0]==e.month+1&&c>=b.day[0]?e.parseDay(b,c):b.year[0]==b.year[1]&&b.month[1]>e.month+1&&b.month[0]<e.month+1?e.parseDay(b,c):b.year[0]==b.year[1]&&b.month[1]==e.month+1&&c<=b.day[1]?e.parseDay(b,c):b.year[0]!=b.year[1]&&b.month[0]<e.month+1&&e.parseDay(b,c))):b.year[0]<e.year&&e.year<b.year[1]?"MONTHLY"!=b.repeat&&"WEEKLY"!=b.repeat||e.parseDay(b,c):e.month+1<=b.month[1]&&e.year==b.year[1]&&("MONTHLY"==b.repeat&&e.parseDay(b,c),"WEEKLY"==b.repeat&&c<=b.day[1]&&e.month+1==b.month[1]?e.parseDay(b,c):"WEEKLY"==b.repeat&&b.year[0]!=b.year[1]&&e.month+1<b.month[1]&&e.parseDay(b,c))):e.year==b.year[0]&&e.month+1==b.month[0]&&e.parseDay(b,c))}),this.curData[c]&&e.isProperlyParsed){var f=[];return this.curData[c].rawDate.filter(function(a,b){return e.month==a.getMonth()&&f.push(this.curData[c].html[b]),!0},this),'<div class="fc-calendar-event">'+f.join('</div><div class="fc-calendar-event">')+"</div>"}return""},b.prototype.generateTemplate=function(b){this.curData=[];var c=this.getHead(),d=this.getBody(),e="";return 4==this.rowTotal?e="fc-four-rows":5==this.rowTotal?e="fc-five-rows":6==this.rowTotal&&(e="fc-six-rows"),this.$cal=a('<div class="fc-calendar '+e+'">').append(c,d),this.$element.find("div.fc-calendar").remove().end().append(this.$cal),this.propDate(),this.$element.trigger(a.Event("shown.calendar.calendario")),b&&b.call(),!0},b.prototype.getHead=function(){for(var b,c,a='<div class="fc-head">',d=0;d<=6;d++)b=d+this.options.startIn,c=b>6?b-6-1:b,a+="<div>"+(this.options.displayWeekAbbr?this.options.weekabbrs[c]:this.options.weeks[c])+"</div>";return a+"</div>"},b.prototype.getBody=function(){for(var a=new Date(this.year,this.month+1,0),b=a.getDate(),c=new Date(this.year,a.getMonth(),1),d=new Date(this.year,this.month,0).getDate(),e='<div class="fc-body"><div class="fc-row">',f=1,g=1,h=1,i=1,j=c.getDay(),k=0,l=0,m="",n=!1,o=!1,p=!1,q=!0,r="",s=0,t="",u={},v="",w=0;w<7;w++){for(var x=0;x<=6;x++)k=j-this.options.startIn,l=k<0?6+k+1:k,m="",n=this.month===this.today.getMonth()&&this.year===this.today.getFullYear()&&f===this.today.getDate(),o=this.year<this.today.getFullYear()||this.month<this.today.getMonth()&&this.year===this.today.getFullYear()||this.month===this.today.getMonth()&&this.year===this.today.getFullYear()&&f<this.today.getDate(),p=f-b>0,q=x<l&&0===w,r="",s=x+this.options.startIn>6?x+this.options.startIn-6-1:x+this.options.startIn,u={},this.options.fillEmpty&&(x<l||w>0)&&(f>b?(i=f++-b,h=this.month+1==12?this.year+1:this.year,g=this.month+1==12?0:this.month+1):1==f&&(i=d++-l+1,h=this.month-1==-1?this.year-1:this.year,g=this.month-1==-1?11:this.month-1),(f>b||1==f)&&(n=g===this.today.getMonth()&&h===this.today.getFullYear()&&i===this.today.getDate(),o=h<this.today.getFullYear()||g<this.today.getMonth()&&h===this.today.getFullYear()||g===this.today.getMonth()&&h===this.today.getFullYear()&&i<this.today.getDate(),u={month:g,year:h},m='<span class="fc-date fc-emptydate">'+i+'</span><span class="fc-weekday">'+this.options.weekabbrs[s]+"</span>",t=Array.prototype.concat(this.caldata[i],this.caldata[this.options.weekabbrs[s].toUpperCase()]).sort(function(a,b){return(a.allDay?"00:00":a.startTime).replace(":","")-(b.allDay?"00:00":b.startTime).replace(":","")}),t&&(r+=this.parseDataToDay(t,i,u)),""!==r&&(m+='<div class="fc-calendar-events">'+r+"</div>"))),f<=b&&(w>0||x>=l)&&(m='<span class="fc-date">'+f+'</span><span class="fc-weekday">'+this.options.weekabbrs[s]+"</span>",t=Array.prototype.concat(this.caldata[f],this.caldata[this.options.weekabbrs[s].toUpperCase()]).sort(function(a,b){return(a.allDay?"00:00":a.startTime).replace(":","")-(b.allDay?"00:00":b.startTime).replace(":","")}),t&&(r+=this.parseDataToDay(t,f,u)),""!==r&&(m+='<div class="fc-calendar-events">'+r+"</div>"),++f),v=(n?"fc-today ":o?"fc-past ":"fc-future ")+(q?"fc-previous-month ":"")+(p?"fc-next-month ":"")+(""!==r?"fc-content":""),e+=(""!==v?'<div class="'+v.trim()+'">':"<div>")+m+"</div>";if(f>b){this.rowTotal=w+1;break}e+='</div><div class="fc-row">'}return e+"</div></div>"},b.prototype.move=function(a,b,c){return"previous"===b?"month"===a?(this.year=this.month>0?this.year:--this.year,this.month=this.month>0?--this.month:11):"year"===a&&(this.year=--this.year):"next"===b&&("month"===a?(this.year=this.month<11?this.year:++this.year,this.month=this.month<11?++this.month:0):"year"===a&&(this.year=++this.year)),this.generateTemplate(c)},b.prototype.option=function(a,b){return b?this.options[a]=b:this.options[a]},b.prototype.getYear=function(){return this.year},b.prototype.getMonth=function(){return this.month+1},b.prototype.getMonthName=function(){return this.options.displayMonthAbbr?this.options.monthabbrs[this.month]:this.options.months[this.month]},b.prototype.getCell=function(b,c){return c?this.$cal.find("span.fc-date").filter(function(){return a(this).text()==b}).parent().data("bz.calendario.dateprop"):this.$cal.find("span.fc-date").filter(function(){return a(this).text()==b}).parent()},b.prototype.setData=function(b,c){return c?this.caldata=this.processCaldata(b):a.extend(this.caldata,this.processCaldata(b)),this.generateTemplate()},b.prototype.gotoNow=function(a){return this.month=this.today.getMonth(),this.year=this.today.getFullYear(),this.generateTemplate(a)},b.prototype.gotoMonth=function(a,b,c){return this.month=a-1,this.year=b,this.generateTemplate(c)},b.prototype.gotoPreviousMonth=function(a){return this.move("month","previous",a)},b.prototype.gotoPreviousYear=function(a){return this.move("year","previous",a)},b.prototype.gotoNextMonth=function(a){return this.move("month","next",a)},b.prototype.gotoNextYear=function(a){return this.move("year","next",a)},b.prototype.feed=function(){return this.syncData.feed?this.syncData.feed:"not-available"},b.prototype.version=function(){return this.INFO.VERSION};var d=a.fn.calendario;a.fn.calendario=c,a.fn.calendario.Constructor=b,a.fn.calendario.noConflict=function(){return a.fn.calendario=d,this}}(jQuery);